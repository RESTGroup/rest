#INFO: **** input file is /share/home/wenxinzy/export/REST/rest/examples/PEN/X3LYP/x3lypg.py ****
#!/usr/bin/env python3                                                                                                                                                                                                                
import pyscf
import numpy
from pyscf import gto, scf, ci,df,lib, dft
import scipy
from time import ctime, time
	   
lib.num_threads(24)
TimeStart = time()
mol = gto.Mole(
        atom='''
             C   -6.1218053484 -0.7171513386  0.0000000000 
             C   -4.9442285958 -1.4113046519  0.0000000000
             C   -3.6803098659 -0.7276441672  0.0000000000 
             C   -2.4688049693 -1.4084918967  0.0000000000
             C   -1.2270315983 -0.7284607452  0.0000000000
             C    0.0000000000 -1.4090846909  0.0000000000
             C    1.2270315983 -0.7284607452  0.0000000000 
             C    2.4688049693 -1.4084918967  0.0000000000 
             C    3.6803098659 -0.7276441672  0.0000000000
             C    4.9442285958 -1.4113046519  0.0000000000
             C    6.1218053484 -0.7171513386  0.0000000000 
             C    6.1218053484  0.7171513386  0.0000000000
             C    4.9442285958  1.4113046519  0.0000000000
             C    3.6803098659  0.7276441672  0.0000000000
             C    2.4688049693  1.4084918967  0.0000000000
             C    1.2270315983  0.7284607452  0.0000000000
             C    0.0000000000  1.4090846909  0.0000000000
             C   -1.2270315983  0.7284607452  0.0000000000
             C   -2.4688049693  1.4084918967  0.0000000000
             C   -3.6803098659  0.7276441672  0.0000000000
             C   -4.9442285958  1.4113046519  0.0000000000
             C   -6.1218053484  0.7171513386  0.0000000000
             H   -7.0692917090 -1.2490690741  0.0000000000
             H   -4.9430735200 -2.4988605526  0.0000000000
             H   -2.4690554105 -2.4968374995  0.0000000000
             H    0.0000000000 -2.4973235097  0.0000000000
             H    2.4690554105 -2.4968374995  0.0000000000
             H    4.9430735200 -2.4988605526  0.0000000000
             H    7.0692917090 -1.2490690741  0.0000000000
             H    7.0692917090  1.2490690741  0.0000000000
             H    4.9430735200  2.4988605526  0.0000000000
             H    2.4690554105  2.4968374995  0.0000000000
             H    0.0000000000  2.4973235097  0.0000000000
             H   -2.4690554105  2.4968374995  0.0000000000
             H   -4.9430735200  2.4988605526  0.0000000000
             H   -7.0692917090  1.2490690741  0.0000000000''',
    basis='cc-pvdz',verbose=4
).build()
method = dft.RKS(mol).density_fit(auxbasis="def2-svp-jkfit")
method.xc = 'x3lypg'
#method.chkfile='restart.chk'
#method.grids.becke_scheme = dft.original_becke
#method.grids.level = 3
#method = scf.RHF(mol).density_fit(auxbasis="def2-svp-jkfit")
method.init_guess = 'vsap'
print('Default DFT(X3LYPG).  E = %.12f' % method.kernel())
print("Total job time: %10.2f(wall)" %(time()-TimeStart))

## store the grids to an external file
#print(len(method.grids.weights))
#ff = open("grids-dz",'w')
#for i in range(len(method.grids.weights)):
#    x,y,z = method.grids.coords[i]
#    w = method.grids.weights[i]
#    ff.write("%16.8e,%16.8e,%16.8e,%16.8e\n" %(x,y,z,w))
#ff.close()

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc04n01', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64')  Threads 24
Python 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
numpy 1.20.3  scipy 1.7.1
Date: Fri Mar 17 14:47:59 2023
PySCF version 2.1.1
PySCF path  /share/apps/rust/anaconda3/lib/python3.9/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 36
[INPUT] num. electrons = 146
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C     -6.121805348400  -0.717151338600   0.000000000000 AA  -11.568535496374  -1.355219619819   0.000000000000 Bohr   0.0
[INPUT]  2 C     -4.944228595800  -1.411304651900   0.000000000000 AA   -9.343237943305  -2.666979270416   0.000000000000 Bohr   0.0
[INPUT]  3 C     -3.680309865900  -0.727644167200   0.000000000000 AA   -6.954777700086  -1.375048192145   0.000000000000 Bohr   0.0
[INPUT]  4 C     -2.468804969300  -1.408491896700   0.000000000000 AA   -4.665365246942  -2.661663933432   0.000000000000 Bohr   0.0
[INPUT]  5 C     -1.227031598300  -0.728460745200   0.000000000000 AA   -2.318753666974  -1.376591300925   0.000000000000 Bohr   0.0
[INPUT]  6 C      0.000000000000  -1.409084690900   0.000000000000 AA    0.000000000000  -2.662784152118   0.000000000000 Bohr   0.0
[INPUT]  7 C      1.227031598300  -0.728460745200   0.000000000000 AA    2.318753666974  -1.376591300925   0.000000000000 Bohr   0.0
[INPUT]  8 C      2.468804969300  -1.408491896700   0.000000000000 AA    4.665365246942  -2.661663933432   0.000000000000 Bohr   0.0
[INPUT]  9 C      3.680309865900  -0.727644167200   0.000000000000 AA    6.954777700086  -1.375048192145   0.000000000000 Bohr   0.0
[INPUT] 10 C      4.944228595800  -1.411304651900   0.000000000000 AA    9.343237943305  -2.666979270416   0.000000000000 Bohr   0.0
[INPUT] 11 C      6.121805348400  -0.717151338600   0.000000000000 AA   11.568535496374  -1.355219619819   0.000000000000 Bohr   0.0
[INPUT] 12 C      6.121805348400   0.717151338600   0.000000000000 AA   11.568535496374   1.355219619819   0.000000000000 Bohr   0.0
[INPUT] 13 C      4.944228595800   1.411304651900   0.000000000000 AA    9.343237943305   2.666979270416   0.000000000000 Bohr   0.0
[INPUT] 14 C      3.680309865900   0.727644167200   0.000000000000 AA    6.954777700086   1.375048192145   0.000000000000 Bohr   0.0
[INPUT] 15 C      2.468804969300   1.408491896700   0.000000000000 AA    4.665365246942   2.661663933432   0.000000000000 Bohr   0.0
[INPUT] 16 C      1.227031598300   0.728460745200   0.000000000000 AA    2.318753666974   1.376591300925   0.000000000000 Bohr   0.0
[INPUT] 17 C      0.000000000000   1.409084690900   0.000000000000 AA    0.000000000000   2.662784152118   0.000000000000 Bohr   0.0
[INPUT] 18 C     -1.227031598300   0.728460745200   0.000000000000 AA   -2.318753666974   1.376591300925   0.000000000000 Bohr   0.0
[INPUT] 19 C     -2.468804969300   1.408491896700   0.000000000000 AA   -4.665365246942   2.661663933432   0.000000000000 Bohr   0.0
[INPUT] 20 C     -3.680309865900   0.727644167200   0.000000000000 AA   -6.954777700086   1.375048192145   0.000000000000 Bohr   0.0
[INPUT] 21 C     -4.944228595800   1.411304651900   0.000000000000 AA   -9.343237943305   2.666979270416   0.000000000000 Bohr   0.0
[INPUT] 22 C     -6.121805348400   0.717151338600   0.000000000000 AA  -11.568535496374   1.355219619819   0.000000000000 Bohr   0.0
[INPUT] 23 H     -7.069291709000  -1.249069074100   0.000000000000 AA  -13.359025224668  -2.360398460713   0.000000000000 Bohr   0.0
[INPUT] 24 H     -4.943073520000  -2.498860552600   0.000000000000 AA   -9.341055166390  -4.722162067893   0.000000000000 Bohr   0.0
[INPUT] 25 H     -2.469055410500  -2.496837499500   0.000000000000 AA   -4.665838512221  -4.718339051599   0.000000000000 Bohr   0.0
[INPUT] 26 H      0.000000000000  -2.497323509700   0.000000000000 AA    0.000000000000  -4.719257477771   0.000000000000 Bohr   0.0
[INPUT] 27 H      2.469055410500  -2.496837499500   0.000000000000 AA    4.665838512221  -4.718339051599   0.000000000000 Bohr   0.0
[INPUT] 28 H      4.943073520000  -2.498860552600   0.000000000000 AA    9.341055166390  -4.722162067893   0.000000000000 Bohr   0.0
[INPUT] 29 H      7.069291709000  -1.249069074100   0.000000000000 AA   13.359025224668  -2.360398460713   0.000000000000 Bohr   0.0
[INPUT] 30 H      7.069291709000   1.249069074100   0.000000000000 AA   13.359025224668   2.360398460713   0.000000000000 Bohr   0.0
[INPUT] 31 H      4.943073520000   2.498860552600   0.000000000000 AA    9.341055166390   4.722162067893   0.000000000000 Bohr   0.0
[INPUT] 32 H      2.469055410500   2.496837499500   0.000000000000 AA    4.665838512221   4.718339051599   0.000000000000 Bohr   0.0
[INPUT] 33 H      0.000000000000   2.497323509700   0.000000000000 AA    0.000000000000   4.719257477771   0.000000000000 Bohr   0.0
[INPUT] 34 H     -2.469055410500   2.496837499500   0.000000000000 AA   -4.665838512221   4.718339051599   0.000000000000 Bohr   0.0
[INPUT] 35 H     -4.943073520000   2.498860552600   0.000000000000 AA   -9.341055166390   4.722162067893   0.000000000000 Bohr   0.0
[INPUT] 36 H     -7.069291709000   1.249069074100   0.000000000000 AA  -13.359025224668   2.360398460713   0.000000000000 Bohr   0.0

nuclear repulsion = 1491.10452165646
number of shells = 152
number of NR pGTOs = 670
number of NR cGTOs = 378
basis = cc-pvdz
ecp = {}
CPU time:         0.30


******** <class 'pyscf.df.df_jk.density_fit.<locals>.DensityFitting'> ********
method = DensityFitting-RKS
initial guess = vsap
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/wenxinzy/export/REST/rest/examples/PEN/X3LYP/tmpktn_fx93
max_memory 4000 MB (current use 74 MB)
XC library pyscf.dft.libxc version 5.2.0
    S. Lehtola, C. Steigemann, M. J. Oliveira, and M. A. Marques, SoftwareX 7, 1 (2018)
XC functionals = x3lypg
    X. Xu and W. A. Goddard, Proc. Natl. Acad. Sci. U. S. A. 101, 2673 (2004)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b3dc8831ca0>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b3dc8831c10>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 3.16228e-05
tot grids = 446184
  HOMO = -0.555169014115191  LUMO = -0.518245668406689
******** <class 'pyscf.df.df.DF'> ********
auxbasis = def2-svp-jkfit
max_memory = 4000
_cderi_to_save = /share/home/wenxinzy/export/REST/rest/examples/PEN/X3LYP/tmprhfopiiz
init E= -843.82156393957
  HOMO = 0.0959917784006945  LUMO = 0.0997071904988184
cycle= 1 E= -837.698335654026  delta_E= 6.12  |g|= 4.93  |ddm|=   30
  HOMO = -0.804629254699136  LUMO = -0.798989432137201
cycle= 2 E= -739.349233431257  delta_E= 98.3  |g|= 16.1  |ddm|=   41
  HOMO = -0.458556742583089  LUMO = -0.429574156061617
cycle= 3 E= -835.390541209395  delta_E=  -96  |g|= 5.51  |ddm|=   28
  HOMO = -0.295074475542847  LUMO = -0.26315956610378
cycle= 4 E= -839.388534101088  delta_E=   -4  |g|= 4.24  |ddm|= 7.74
  HOMO = -0.202457263809906  LUMO = -0.152648869872944
cycle= 5 E= -846.32271799694  delta_E= -6.93  |g|= 0.584  |ddm|= 4.64
  HOMO = -0.178435684715046  LUMO = -0.103122503910737
cycle= 6 E= -846.333674872418  delta_E= -0.011  |g|= 0.631  |ddm|= 1.33
  HOMO = -0.177940660220855  LUMO = -0.0946531970513675
cycle= 7 E= -846.440309994865  delta_E= -0.107  |g|= 0.0843  |ddm|= 0.687
  HOMO = -0.174794156191836  LUMO = -0.0914659258879992
cycle= 8 E= -846.441512966037  delta_E= -0.0012  |g|= 0.0566  |ddm|= 0.133
  HOMO = -0.175807066410557  LUMO = -0.092210922978749
cycle= 9 E= -846.442248595349  delta_E= -0.000736  |g|= 0.0108  |ddm|= 0.0577
  HOMO = -0.175818422530031  LUMO = -0.0922005951177627
cycle= 10 E= -846.442281401423  delta_E= -3.28e-05  |g|= 0.00469  |ddm|= 0.0159
  HOMO = -0.175663765651399  LUMO = -0.0920727336919167
cycle= 11 E= -846.442286707773  delta_E= -5.31e-06  |g|= 0.000534  |ddm|= 0.0053
  HOMO = -0.17569419920517  LUMO = -0.0921022072135205
cycle= 12 E= -846.442286774459  delta_E= -6.67e-08  |g|= 0.000228  |ddm|= 0.000726
  HOMO = -0.175702125603491  LUMO = -0.0921085788086589
cycle= 13 E= -846.442286788927  delta_E= -1.45e-08  |g|= 8.35e-05  |ddm|= 0.000329
  HOMO = -0.17570492335023  LUMO = -0.0921112942095302
cycle= 14 E= -846.442286790619  delta_E= -1.69e-09  |g|= 2.17e-05  |ddm|= 0.000124
  HOMO = -0.175704725580259  LUMO = -0.0921110687992202
cycle= 15 E= -846.442286790648  delta_E= -2.96e-11  |g|= 1.82e-05  |ddm|= 3.68e-05
  HOMO = -0.175705480926308  LUMO = -0.0921117544050169
Extra cycle  E= -846.442286790396  delta_E= 2.52e-10  |g|= 3.49e-05  |ddm|= 5.52e-05
converged SCF energy = -846.442286790396
Default DFT(X3LYPG).  E = -846.442286790396
Total job time:      49.78(wall)
